
FROM ubuntu@sha256:626ffe58f6e7566e00254b638eb7e0f3b11d4da9675088f4781a50ae288f3322


# Install challenge dependencies within the image
RUN apt-get update && apt-get install -y \
    openssh-server \
    socat \
    python3
RUN apt-get install -y g++

# Create challenge dir for metadata.json and other file artifacts
RUN mkdir /challenge


# Bring in all environment vars from cmgr
ARG SEED
ARG FLAG_FORMAT
ARG FLAG


COPY config-box.py /challenge/config-box.py
COPY profile /challenge/profile
COPY start.sh /opt/start.sh
COPY src.cpp /home/ctf-player/src.cpp

RUN python3 /challenge/config-box.py


RUN chmod 0000 /challenge
RUN chmod 0000 /challenge/*
EXPOSE 8022
# PUBLISH 8022 AS ssh
CMD ["/opt/start.sh"]
