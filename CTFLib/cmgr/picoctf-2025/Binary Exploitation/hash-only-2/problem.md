# hash-only-2

- Namespace: picoctf
- ID: hash-only-2
- Type: custom
- Category: Binary Exploitation
- Points: 200
- Templatable: yes
- MaxUsers: 1

## Description

Here is a binary that has enough privilege to read the content of the flag file but will only let you know its hash. If only it could just give you the actual content!

## Details
Connect using `ssh ctf-player@{{server("ssh")}} -p {{port("ssh")}}` with the password, `{{lookup("password")}}` and run the binary named "flaghasher".


## Hints

## Solution Overview

The user is expected to analyze the binary and notice (using the strings, a disassembler, or any other reverse engineering method) that it is computing a hash of the flag file through the use of the command "md5sum"
The user will therefore ssh to the challenge box and notice that he/she has the privileges to write the /usr/local/bin/ directory which in the $PATH has priority over the directory that contains the legitimate md5sum (i.e. /usr/bin).
He/She can therefore trick the program into executing cat instead of md5sum using: cp /usr/bin/cat /usr/local/bin/md5sum
## Challenge Options

```yaml
cpus: 0.5
memory: 128m
ulimits:
  - nofile=128:128
diskquota: 64m
```

## Learning Objective

Insecure shell command execution, Permissions, Linux system binaries, and $PATH

## Tags

## Attributes

- author: Junias Bonou
- organization: Cylab Africa
- event: picoCTF 2025
