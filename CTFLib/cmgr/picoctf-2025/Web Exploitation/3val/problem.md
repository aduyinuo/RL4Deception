# 3v@l

- Namespace: picoctf
- ID: 3val
- Type: custom
- Category: Web Exploitation
- Points: 200
- Templatable: yes
- MaxUsers: 1

## Description

ABC Bank's website has a loan calculator to help its clients calculate the amount they pay if they take a loan from the bank. Unfortunately, they are using an `eval` function to calculate the loan. Bypassing this will give you Remote Code Execution (RCE). Can you exploit the bank's calculator and read the flag?

## Details

The website is running {{link_as("/", "Here")}}.


## Hints

- Bypass regex
- The flag file is `/flag.txt`
- You might need encoding or dynamic construction to bypass restrictions.

## Challenge Options

```yaml
  cpus: 0.5
  memory: 128m
  ulimits:
    - nofile=128:128
  diskquota: 64m
```

## Solution Overview

The input field is vulnerable to Remote Code Execution (RCE) as it is using eval function, allowing execution of arbitrary Python code. To exploit this, write Python code to read the flag instead of performing math calculations. Inspect the HTML source code or document structure to understand regex patterns and blocked functions, and use a payload like` open(__import__('base64').b64decode('L2ZsYWcudHh0Cg==').decode('utf-8').strip()).read()` or using dynamic construction like `open(chr(47)+ "flag" + chr(46) + "txt", "r").read()`to exploit the vulnerability.

## Learning Objective

Remote Code Execution

## Tags

- Web
- RCE
- Flask

## Attributes

- author: Theoneste Byagutangaza
- organization: Cylab Africa
- event: picoCTF 2025
