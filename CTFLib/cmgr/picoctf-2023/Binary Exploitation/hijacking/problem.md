# hijacking
- Namespace: picoctf/picoctf2023
- ID: hijacking
- Type: custom
- Category: Binary Exploitation
- Points: 200
- Templatable: yes
- MaxUsers: 1

## Description
Getting root access can allow you to read the flag. Luckily there is a python file that you might like to play with.

## Details
Through Social engineering, we've got the credentials to use on the server. SSH is running on the server.
```
{{server("ssh")}} {{port("ssh")}}
Username: {{lookup("username")}}
Password: {{lookup("password")}}
```

## Hints
- Check for Hidden files
- No place like Home:)

## Solution Overview
base64 module in python script have a write permission.By running sudo -l command to see which scripts or binaries
a user can run with elevated access, he found picoctf ALL=(root) NOPASSWD: /usr/bin/python3  /home/picoctf/.server.py. so the user have to edit
/usr/lib/python3.8/base64.py with vi or vim by including
import os
os.system('/bin/bash')
and run `sudo /usr/bin/python3 /home/picoctf/.server.py` to get root access.


## Learning Objective
Basic understanding of python library hijacking and exploitation.

## Challenge Options

```yaml
cpus: 0.5
memory: 128m
pidslimit: 20
ulimits:
  - nofile=128:128
diskquota: 64m
init: true
```

## Tags

- privilege_escalation

## Attributes
- author: Theoneste Byagutangaza
- organization: Cylab Africa
- event: picoCTF 2023
