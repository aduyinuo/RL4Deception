FROM ubuntu:20.04


# Install challenge dependencies within the image
RUN apt-get update && DEBIAN_FRONTEND=noninteractive apt-get install -y libc6-dev-i386 make socat bsdmainutils

# Declare Flag and Canary as Env Vars
ENV FLAG="picoCTF{ov3rfl0ws_ar3nt_that_bad_"

# Create challenge dir for metadata.json and other file artifacts
RUN mkdir /challenge


COPY profile /challenge/profile
COPY Makefile /challenge/Makefile
COPY vuln.c /challenge/vuln.c
COPY start.sh /opt/start.sh

WORKDIR /challenge
ARG SEED
RUN make

EXPOSE 9113
# PUBLISH 9113 AS overflow
CMD ["/opt/start.sh"]
