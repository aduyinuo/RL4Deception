FROM ubuntu:20.04


# Install challenge dependencies within the image
RUN apt-get update && DEBIAN_FRONTEND=noninteractive apt-get install -y libc6-dev-i386 make socat bsdmainutils

# Declare Flag and Canary as Env Vars
ENV FLAG="picoCTF{addr3ss3s_ar3_3asy_"

# Create challenge dir for metadata.json and other file artifacts
RUN mkdir /challenge


COPY profile /challenge/profile
COPY Makefile /challenge/Makefile
COPY vuln.c /challenge/vuln.c
COPY asm.S /challenge/asm.S
COPY asm.h /challenge/asm.h
COPY start.sh /opt/start.sh

WORKDIR /challenge
ARG SEED
RUN make

EXPOSE 9114
# PUBLISH 9114 AS overflow1
CMD ["/opt/start.sh"]
